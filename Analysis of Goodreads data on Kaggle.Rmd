---
title: "Analysis of Goodreads data on Kaggle"
author:
  - name: Hoang Anh NGO
  - affiliation: Ecole Polytechnique, IP Paris
output: html_notebook
---

#Loading libraries and understanding the basics of this dataset

##Loading libraries

First, we will load all the necessary libraries for this notebook.

```{r}
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(viridis)  
library(WVPlots)
library(naniar)
library(e1071)
library(plotrix)
library(ggcorrplot)
```

##Understanding the basic structure of the dataset

We import and investigate the structure of the dataset.

```{r}
goodreads <- read.csv('/Users/ngohoanganh/Desktop/Goodreads Kaggle project/books.csv', stringsAsFactors = FALSE)
str(goodreads)
head(goodreads)
print(paste('The original goodreads book dataset has',nrow(goodreads),'rows and',ncol(goodreads),'columns.'))
```

##Fixing problems of the dataset

First of all, we know that this dataset has 13724 observations with 10 variables. There is one variable that is supposed to be written as "# num_pages". However, as R cannot read special characters in column names, for the sake of convenience, we rename this variable as "num_pages". 

We obverse some problems with this dataset. At columns 4 and 8 (corresponding to variables "average_rating" and "num_page"), we can see that the observations are of type "character", while they should be of type "integer". We fix the problem with the function as.numeric in the following code chunk.

However, while fixing the problem above, those two columns yield some NA values. This can be due to those rows having too many commas, forcing the values that should belong to one columns move to another column. We omit these outliers for a clean dataset by using the function na.omit. 

Moreover, one of the famous authors that we know, J.K Rowling, has a fairly long name of "J.K Rowling-Mary GrandPré". After changing the author's name, we have the dataset available for further analysis.

```{r}
goodreads[goodreads=='J.K. Rowling-Mary GrandPré'] <- 'J.K. Rowling'
head(goodreads)
for(i in c(4,8)) {
  goodreads[,i] <- as.numeric(goodreads[,i])
}
names(goodreads)[names(goodreads) == "X..num_pages"] <- "num_pages"
goodreads <- na.omit(goodreads)
str(goodreads)  
print(paste('The final goodreads book dataset has',nrow(goodreads),'rows and',ncol(goodreads),'columns.'))
```

After fixing all the errors appeared in the dataset, we start to define the variables' names. Their description is as follow:
  - **bookID**: the unique ID for each book/series
  - **title**: the title of each book/series
  - **authors**: the author(s) of the particular book/series
  - **average_rating**: the average ratings of the particular book/series, given by Goodreads' users
  - **ISBN**: old ISBN number of 10 digits, including information about a book/series, for example name, author(s), publisher, genre, etc.
  - **ISBN13**: new ISBN number of 13 digits, introduced in 2007
  - **Language_code**: 3-character language code, which indicates the language in which the book is written
  - **Num_page**: number of pages of each book/series
  - **Ratings_count**: number of ratings given by users for each book/series
  - **Text_reviews_count**: number of text reviews (apart from point reviews of scale 5) given by users for each book/series
  
##Missingness of data
We investigate whether there is any data cell missing with the vis_miss plot. Since we do not plot any significant in the plot, and it shows that less than 0.1% of the data is missing, we use gg_miss_var to get the exact number of data cells missing in each column. The result is, surprisingly, there is no data misising.
  
```{r}
vis_miss(goodreads)
gg_miss_var(goodreads)

```
  
#Exploratory Data Analysis (EDA) of the dataset Goodreads

In this part, we will answer some of the interesting exploratory questions by visualizing data.

##Correlation between numerical columns 

First, we will see the correlation between numerical columns of this dataset by using Pearson's R, Kendall rank and Spearman correlation coefficient.
  - Pearson's R correlation coefficient is used to examine the strength and direction of the linear relationship between two continuous variables.
  - Kendall rank correlation coefficient (or Kendall tau's coefficient) is a statistic used to measure the ordinal association between two measured quantities. 
  - Spearman's rank correlation coefficient (or Spearman's rho) is a non-parametric measure of rank correlation (statistical dependence between the rankings of two variables). It assesses how well the relationship between two variables can be described using a monotonic function.

```{r}
goodreads_corr <- subset(goodreads, select = c('average_rating','num_pages','ratings_count','text_reviews_count'))

goodreads_corr_pearson_round2 <- round(cor(goodreads_corr, method = "pearson", use = "pairwise.complete.obs"), 2)
data.frame(goodreads_corr_pearson_round2)

goodreads_corr_kendall_round2 <- round(cor(goodreads_corr, method = "kendall", use = "pairwise.complete.obs"), 2)
data.frame(goodreads_corr_kendall_round2)

goodreads_corr_spearman_round2 <- round(cor(goodreads_corr, method = "spearman", use = "pairwise.complete.obs"), 2)
data.frame(goodreads_corr_spearman_round2)

ggcorrplot(goodreads_corr_pearson_round2, hc.order = TRUE,
   lab = TRUE,
   title = "Pearson's R correlation matrix for Goodreads numerical variables",
   outline.col = "white",
   ggtheme = ggplot2::theme_gray,
   colors = c("#6D9EC1", "white", "#E46726"))


ggcorrplot(goodreads_corr_kendall_round2, hc.order = TRUE,
   lab = TRUE,
   title = "Kendall correlation matrix for Goodreads numerical variables",
   outline.col = "white",
   ggtheme = ggplot2::theme_gray,
   colors = c("#6D9EC1", "white", "#E46726"))

ggcorrplot(goodreads_corr_spearman_round2, hc.order = TRUE,
   lab = TRUE,
   title = "Spearman correlation matrix for Goodreads numerical variables",
   outline.col = "white",
   ggtheme = ggplot2::theme_gray,
   colors = c("#6D9EC1", "white", "#E46726"))
```

From the three correlation matrices above, we can see that there is only one pair of numerical variables that are strongly correlated to each other, which is ratings_count and text_reviews_count. All of the correlation coefficients of these two variables, regardless of the method used, are always greater than 0.8, which can be considered to be a strong correlation. The remaining pairs of variables show little positive correlation, with all the remaining coefficients of less than 0.2, some are even less than 0.05.

This shows an intuitive result that the more readers rate a book on a scale of 0 to 5, the more readers will leave a written text review for the same book.

##Histogram plot of numerical variables

First, we will plot the histograms of the numerical/integer variables, including average_rating, num_pages, ratings_count and text_reviews_count. 

```{r}
ggplot(data = goodreads, aes(x = goodreads$average_rating)) + 
    geom_histogram(aes(y = ..density..),binwidth = 0.01, color='orange', fill='orange') +
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for books' average ratings", x = "Average ratings", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)

ggplot(data = goodreads, aes(x = goodreads$num_pages)) + 
    geom_histogram(aes(y = ..density..),binwidth = 10, color='orange', fill='orange') +
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for books' number of pages", x = "Number of pages", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)

ggplot(data = goodreads, aes(x = goodreads$ratings_count)) + 
    geom_histogram(aes(y = ..density..),binwidth = 100, color='orange', fill='orange') +
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for ratings count of each book/series", x = "Ratings count", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)

ggplot(data = goodreads, aes(x = goodreads$text_reviews_count)) + 
    geom_histogram(aes(y = ..density..),binwidth = 50 , color='orange', fill='orange') +
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for text reviews count for each book/series", x = "Text reviews count", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)
```

The histogram of average_ratings shows that most of the ratings lie between 3 and 5. The distribution of ratings between 3 and 5 seems to be familiar to a normal distribution (i.e most of the ratings focus around 4, and the density decreases upon reaching the edges). Later, we will investigate this distribution and test how close is it to the normal distribution.

With the histogram of num_pages, most of the books have less than 1000 pages, with many of them having 250-500 pages. Later, we will also zoom into this part of the histogram to have a closer look of the distribution.

The histograms of ratings_count and text_reviews_count is so much heavily skewed to the left that we can only see a straight small bar at the position 0, and the density curve decreases to 0 shortly. As such, to further investigate the distribution of these variables, we have to later take a closer look at the positions around 0. 

##Basic statistics of numerical variables

First, as R does not have a built in function to calculate the mode of a dataset, we proceed to define that function ourselves as follow.

```{r}
# Define the function getmode in R to get the mode of data (appearance with highest frequency)
getmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}
```

Now, we will generate a table of basic properties of each variable.

```{r}
basic_statistics_goodreads <- data.frame(matrix(NA, ncol = 13, nrow = 10))
names(basic_statistics_goodreads) <- c('Variable',
                             'Minimum score',
                             '25th percentile',
                             'Median',
                             'Mean score',
                             '75th percentile',
                             'Maximum score',
                             'Value with highest frequency (mode)',
                             'Frequency of mode',
                             'Standard Deviation',
                             'SE Mean',
                             'Skewness',
                             'Kurtosis')

for(i in c(4,8:10)) {
  basic_statistics_goodreads[i,1] <- colnames(goodreads)[i]
  basic_statistics_goodreads[i,2] <- min(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,3] <- quantile(goodreads[,i], 0.25, na.rm = TRUE)
  basic_statistics_goodreads[i,4] <- quantile(goodreads[,i], 0.5, na.rm = TRUE)
  basic_statistics_goodreads[i,5] <- mean(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,6] <- quantile(goodreads[,i], 0.75, na.rm = TRUE)
  basic_statistics_goodreads[i,7] <- max(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,8] <- getmode(na.omit(goodreads[,i]))
  basic_statistics_goodreads[i,9] <- sum(goodreads[,i] == basic_statistics_goodreads[i,8])
  basic_statistics_goodreads[i,10] <- sd(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,11] <- std.error(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,12] <- skewness(goodreads[,i], na.rm = TRUE)
  basic_statistics_goodreads[i,13] <- kurtosis(goodreads[,i], na.rm = TRUE)
}

basic_statistics_goodreads <- na.omit(basic_statistics_goodreads)
View(basic_statistics_goodreads)
```

First of all, we see an interesting fact that the mode of text_reviews_count is 0 (more than 900 books receive 0 text reviews), which means that books having 0 text reviews occur the most frequently in the dataset. Moreover, the mode of average_ratings is also exactly 4.0, which shows that readers are really generous with the books they are reading.

Among the 4 variables, there is only one variable (average_ratings) that has a negative skewness. This is due to the fact that the histogram of this variable skews heavily to the right, with most of the observations lie between 3 and 5. The three remaining variables has a significantly positive skewness, which means that these variables skew heavily to the left. This can be verified by looking at the histograms of these variables.

We also note that the 75th percentile of each variable, apart from average_ratings, is relatively very small comparing to the maximum, which can also explain the positive skewness of those variables.

All 4 variables have a positive kurtosis, which shows that the distribution of these variables have heavier tails than the normal distribution with the same mean and standard deviation. 

From the properties witnessed above, to better understand the distribution of variables within specific ranges, we again generate histograms for two variables, ratings_count and text_reviews_count. This time, we will set the limit of the x-axis to be 100 for num_pages, 5000 for ratings_count and 500 for text_reviews_count.

```{r}
ggplot(data = goodreads, aes(x = goodreads$num_pages)) + 
    geom_histogram(aes(y = ..density..),binwidth = 20, color='orange', fill='orange') +
    xlim(c(0,1000)) + 
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for books' number of pages", x = "Number of pages", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)

ggplot(data = goodreads, aes(x = goodreads$ratings_count)) + 
    geom_histogram(aes(y = ..density..),binwidth = 10, color='orange', fill='orange') +
    xlim(c(0,5000)) + 
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for ratings count of each book/series", x = "Ratings count", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)

ggplot(data = goodreads, aes(x = goodreads$text_reviews_count)) + 
    geom_histogram(aes(y = ..density..),binwidth = 1 , color='orange', fill='orange') +
    xlim(c(0,500)) + 
    geom_density(colour="blue", lwd = 0.5, alpha=0.5) + 
    labs(title="Histogram for text reviews count for each book/series", x = "Text reviews count", y = "Number of books") + 
    geom_vline(data = goodreads, xintercept = mean(goodreads$average_rating, na.rm = TRUE), color = "red", linetype = "dashed", size = 0.5)
```

##Rating distribustion of books in the dataset

```{r}
rating_distribution_goodreads <- data.frame(matrix(0, ncol = 3, nrow = 5))
names(rating_distribution_goodreads) <- c('Range',
                             'number_of_books',
                             'percentage')

for(i in c(1:5)) {
  rating_distribution_goodreads[i,1] <- paste('Between',i-1,'and',i)
}

for(i in c(1:nrow(goodreads))) {
  if (goodreads[i,4] >= 0 & goodreads[i,4] < 1) {
    rating_distribution_goodreads[1,2] = rating_distribution_goodreads[1,2] + 1 
  }
  if (goodreads[i,4] >= 1 & goodreads[i,4] < 2) {
    rating_distribution_goodreads[2,2] = rating_distribution_goodreads[2,2] + 1 
    }
  if (goodreads[i,4] >= 2 & goodreads[i,4] < 3) {
    rating_distribution_goodreads[3,2] = rating_distribution_goodreads[3,2] + 1 
    }
  if (goodreads[i,4] >= 3 & goodreads[i,4] < 4) {
    rating_distribution_goodreads[4,2] = rating_distribution_goodreads[4,2] + 1 
    }
  if (goodreads[i,4] >= 4 & goodreads[i,4] < 5) {
    rating_distribution_goodreads[5,2] = rating_distribution_goodreads[5,2] + 1 
  }
}

rating_distribution_goodreads$percentage <- round((rating_distribution_goodreads$number_of_books)/nrow(goodreads)*100,digits = 2)

rating_distribution_goodreads
```


##Books with the most occurences in the dataset

```{r}
book_frequency <- data.frame(table(goodreads$title), stringsAsFactors = FALSE)
names(book_frequency) <- c('title','frequency')
book_frequency <- book_frequency[order(-book_frequency$frequency),] 
head(book_frequency)

book_frequency_top20 <- book_frequency[c(1:20),]
ggplot(data=book_frequency_top20, aes(x=reorder(title, frequency),y=frequency, fill = factor(c(1:nrow(book_frequency_top20))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  ggtitle('20 books with highest frequency') + 
  labs(x = "Title", y = "Frequency") 
```

Above, we have plotted the 20 books with the most appearances in the dataset. We can see that "One Hundred Year of Solitude" and "Salem's Lot" are the two books appearing the most, with 11 times for each book.

These books are published again and again, each time with another publisher. This shows that these are still in great demand, despite the flow of time.

```{r}
book_language <- data.frame(table(goodreads$language_code), stringsAsFactors = FALSE)
names(book_language) <- c('language','frequency')
book_language <- book_language[order(-book_language$frequency),]
book_language$percentage <- round(book_language$frequency/nrow(goodreads)*100, digits = 2)
head(book_language)

ggplot(book_language, aes(x=reorder(language,-frequency),y=frequency, fill = factor(c(1:nrow(book_language))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  ggtitle('Languages written in books/series') + 
  labs(x = "Language", y = "Total number of books") +
  geom_text(aes(label=frequency), vjust=-0.5)
```

```{r}
book_ratings_count <- goodreads[order(-goodreads$ratings_count),]

book_ratings_count_top10 <- book_ratings_count[c(1:10),]
book_ratings_count_top10
ggplot(data=book_ratings_count_top10, aes(x=reorder(title, ratings_count),y=ratings_count, fill = factor(c(1:nrow(book_ratings_count_top10))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Paired") + 
  ggtitle('Books/series with highest number of ratings') + 
  labs(x = "Book/series", y = "Number of ratings") +
  geom_text(
    aes(label = ratings_count), colour = "black",
    hjust = -0.1, size = 2,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

author_most_book_ratings_count <- data.frame(table(book_ratings_count_top10$authors))
names(author_most_book_ratings_count) <- c('author', 'number_of_books')
author_most_book_ratings_count <- author_most_book_ratings_count[order(-author_most_book_ratings_count$number_of_books),]
author_most_book_ratings_count
```

```{r}
book_text_reviews_count <- goodreads[order(-goodreads$text_reviews_count),]

book_text_reviews_count_top10 <- book_text_reviews_count[c(1:10),]
book_text_reviews_count_top10
ggplot(data=book_text_reviews_count_top10, aes(x=reorder(title, text_reviews_count),y=text_reviews_count, fill = factor(c(1:nrow(book_text_reviews_count_top10))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Paired") + 
  ggtitle('Books/series with highest number of text reviews') + 
  labs(x = "Book/series", y = "Number of text reviews") +
  geom_text(
    aes(label = text_reviews_count), colour = "black",
    hjust = -0.1, size = 2,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

author_most_book_text_reviews_count <- data.frame(table(book_text_reviews_count_top10$authors))
names(author_most_book_text_reviews_count) <- c('author', 'number_of_books')
author_most_book_text_reviews_count <- author_most_book_text_reviews_count[order(-author_most_book_text_reviews_count$number_of_books),]
author_most_book_text_reviews_count
```


```{r}
author_most_books <- data.frame(table(goodreads$authors), stringsAsFactors = FALSE)
names(author_most_books) <- c('author','total_number_of_books')
author_most_books <- author_most_books[order(-author_most_books$total_number_of_books),] 
head(author_most_books)

author_most_books_top10 <- author_most_books[c(1:10),]
ggplot(data=author_most_books_top10, aes(x=reorder(author, total_number_of_books),y=total_number_of_books, fill = factor(c(1:nrow(author_most_books_top10))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Set3") + 
  ggtitle('Author with greatest number of books appeared') + 
  labs(x = "Author", y = "Total number of books") +
  geom_text(
    aes(label = total_number_of_books), colour = "black",
    hjust = -0.5, size = 3,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

author_most_books_top10

```

##What are the authors with the greatest number of highly-ranked books?
The definition of "highly-ranked books" in this context is relative. As such, we consider some of the following cases. We define a book to be highly-ranked if its average ranking is greater than:
  - 4.0
  - 4.3
  - 4.5
  

```{r}
author_most_book_high_ratings <- goodreads[goodreads$average_rating >= 4.0,]
author_most_books_high_ratings <- data.frame(table(author_most_book_high_ratings$authors), stringsAsFactors = FALSE)
names(author_most_books_high_ratings) <- c('author','number_of_books_>=_4.0')
author_most_books_high_ratings <- author_most_books_high_ratings[order(-author_most_books_high_ratings$`number_of_books_>=_4.0`),] 

author_most_book_high_ratings_2 <- goodreads[goodreads$average_rating >= 4.3,]
author_most_books_high_ratings_2 <- data.frame(table(author_most_book_high_ratings_2$authors), stringsAsFactors = FALSE)
names(author_most_books_high_ratings_2) <- c('author','number_of_books_>=_4.3')
author_most_books_high_ratings_2 <- author_most_books_high_ratings_2[order(-author_most_books_high_ratings_2$`number_of_books_>=_4.3`),] 

author_most_book_high_ratings_3 <- goodreads[goodreads$average_rating >= 4.5,]
author_most_books_high_ratings_3 <- data.frame(table(author_most_book_high_ratings_3$authors), stringsAsFactors = FALSE)
names(author_most_books_high_ratings_3) <- c('author','number_of_books_>=_4.5')
author_most_books_high_ratings_3 <- author_most_books_high_ratings_3[order(-author_most_books_high_ratings_3$`number_of_books_>=_4.5`),] 

author_most_books_high_ratings_top10 <- author_most_books_high_ratings[c(1:10),]
ggplot(data=author_most_books_high_ratings_top10, aes(x=reorder(author, `number_of_books_>=_4.0`),y=`number_of_books_>=_4.0`, fill = factor(c(1:nrow(author_most_books_high_ratings_top10))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Set3") + 
  ggtitle('Author with greatest number of books ranked >= 4.0') + 
  labs(x = "Author", y = "Total number of highly books ranked >= 4.0") +
  geom_text(
    aes(label = `number_of_books_>=_4.0`), colour = "black",
    hjust = -0.5, size = 3,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

author_most_books_high_ratings_top10_2 <- author_most_books_high_ratings_2[c(1:10),]
ggplot(data=author_most_books_high_ratings_top10_2, aes(x=reorder(author, `number_of_books_>=_4.3`),y=`number_of_books_>=_4.3`, fill = factor(c(1:nrow(author_most_books_high_ratings_top10_2))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Set3") + 
  ggtitle('Author with greatest number of books ranked >= 4.3') + 
  labs(x = "Author", y = "Total number of books ranked >= 4.3") +
  geom_text(
    aes(label = `number_of_books_>=_4.3`), colour = "black",
    hjust = -0.5, size = 3,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

author_most_books_high_ratings_top10_3 <- author_most_books_high_ratings_3[c(1:10),]
ggplot(data=author_most_books_high_ratings_top10_3, aes(x=reorder(author, `number_of_books_>=_4.5`),y=`number_of_books_>=_4.5`, fill = factor(c(1:nrow(author_most_books_high_ratings_top10_3))))) +
  theme(legend.position = "none") + 
  geom_bar(stat="identity") +
  coord_flip() +
  scale_fill_brewer(palette="Set3") + 
  ggtitle('Author with greatest number of books ranked >= 4.5') + 
  labs(x = "Author", y = "Total number of books ranked >= 4.5") +
  geom_text(
    aes(label = `number_of_books_>=_4.5`), colour = "black",
    hjust = -0.5, size = 3,
    position = position_dodge(width = 1),
    inherit.aes = TRUE
  )

x <- Reduce(function(x,y) merge(x,y,by="author",all=TRUE) ,list(author_most_books_high_ratings_top10,author_most_books_high_ratings_top10_2,author_most_books_high_ratings_top10_3))

x
```

```{r}
ScatterHist(goodreads, "average_rating", "text_reviews_count", title = "abc", binwidth_x = 0.01, binwidth_y = 100) +
  scale_fill_manual("red") + 
  labs(x = 'Average rating', y = "Number of ratings")
  
```

